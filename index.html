<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Das Verhör | Magische Selbsterkenntnis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Orbitron:wght@400;700&display=swap');
        
        :root {
            --neon-gold: #d4af37;
            --neon-glow: rgba(212, 175, 55, 0.6);
            --magic-purple: #2d004d;
        }

        body { 
            background-color: #020202; 
            color: var(--neon-gold); 
            font-family: 'Orbitron', sans-serif; 
            overflow: hidden; 
            margin: 0;
        }

        /* Magischer Hintergrund */
        #bg-canvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1;
            background: radial-gradient(circle at center, #0a001a 0%, #000 100%);
        }

        /* Neon-Vignette */
        .vignette {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 30%, rgba(0,0,0,0.9) 100%);
            box-shadow: inset 0 0 150px #000;
            pointer-events: none;
            z-index: 50;
        }

        .page { 
            min-height: 100vh; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            position: absolute; 
            width: 100%; 
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1); 
            z-index: 10;
            text-align: center;
        }

        .hidden { opacity: 0; transform: scale(0.8) translateY(50px); pointer-events: none; }

        /* Neon Text Effekt */
        .neon-text {
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            letter-spacing: 5px;
            text-shadow: 0 0 10px var(--neon-glow), 0 0 20px var(--neon-glow), 0 0 40px var(--magic-purple);
            animation: flicker 3s infinite alternate;
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            95% { opacity: 0.8; }
            97% { opacity: 1; }
            99% { opacity: 0.9; }
        }

        /* Magischer Input */
        input { 
            background: rgba(255, 255, 255, 0.03); 
            border: 1px solid var(--neon-gold); 
            box-shadow: 0 0 15px var(--neon-glow);
            outline: none; 
            padding: 15px; 
            width: 100%; 
            max-width: 500px; 
            color: #fff; 
            font-family: 'Orbitron', sans-serif; 
            font-size: 1.1rem; 
            text-align: center; 
            border-radius: 5px;
            transition: all 0.3s;
        }

        input:focus {
            box-shadow: 0 0 30px var(--neon-glow), inset 0 0 10px var(--neon-glow);
            transform: scale(1.02);
        }

        /* Jumpscare */
        #jumpscare {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background: #000;
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        #jumpscare img { width: 100%; height: 100%; object-fit: cover; filter: contrast(150%) brightness(80%); }

        .shake { animation: shake-anim 0.05s infinite; }
        @keyframes shake-anim {
            0% { transform: translate(2px, 2px); }
            50% { transform: translate(-2px, -2px); }
            100% { transform: translate(2px, -2px); }
        }

        .final-list {
            background: rgba(10, 0, 20, 0.8);
            border: 1px solid var(--neon-gold);
            box-shadow: 0 0 20px var(--magic-purple);
            padding: 2rem;
            border-radius: 1rem;
        }
    </style>
</head>
<body>

    <div class="vignette"></div>
    <canvas id="bg-canvas"></canvas>

    <div id="jumpscare">
        <img src="death.JPG" alt="!!!">
    </div>

    <div id="survey-container"></div>

    <div id="final-page" class="page hidden">
        <div class="final-list">
            <h2 class="neon-text text-2xl mb-4">Erkenntnis erlangt</h2>
            <p class="text-sm italic text-gray-400 mb-8">Deine Seele wurde digitalisiert.</p>
            <div id="live-list" class="space-y-3 text-xs"></div>
        </div>
    </div>

    <script>
        const FORMSPREE_URL = "https://formspree.io/f/mzdayryq"; 
        const SUPABASE_URL = 'https://xqlxartkonbvzlkvewfq.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_2ntA31uO8udqoaeFbncT8Q_R1rvhyt_';
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        const fragen = [
            "Wer bist du?", "Wer bist du wirklich?", "Wer willst du sein?", "Wer willst du einmal werden?",
            "Wer wolltest du immer werden?", "Wohin wolltest du schon immer?", "Gefällt es dir, wo du bist?",
            "Wo wärst du am liebsten jetzt?", "Bist du hungrig?", "Was möchtest du jetzt essen?",
            "Warum wartest du auf den ersten Schritt deines Gegenübers?", "Hast du schon einmal etwas gestohlen?",
            "Hast du jemals Drogen konsumiert?", "Hast du schon mal jemand betrogen?", "Bist du ehrlich?",
            "Ist heute schönes Wetter?", "Welches Auto fährst du?", "Wann hast du Feierabend?",
            "Bist du sportlich?", "Hattest du schon mal Angst?", "Vor was denn?",
            "War das Warum der gleiche Grund wie das wovon?", "Welche ist deine Lieblingsfarbe?",
            "Warum?", "Welches ist dein Lieblingsessen?", "Warum?"
        ];

        let answers = {};
        let startTime = Date.now();

        function build() {
            const container = document.getElementById('survey-container');
            fragen.forEach((q, i) => {
                const div = document.createElement('div');
                div.id = `s-${i}`;
                div.className = `page ${i === 0 ? '' : 'hidden'}`;
                div.innerHTML = `
                    <p class="text-[10px] tracking-[0.5em] mb-4 opacity-50">SYNCING REALITY...</p>
                    <h2 class="neon-text text-xl md:text-3xl mb-12 px-6">${q}</h2>
                    <input type="text" id="i-${i}" onkeypress="checkEnter(event, ${i})" autocomplete="off" placeholder="Antworte...">
                `;
                container.appendChild(div);
            });
        }

        function checkEnter(e, i) { if(e.key === "Enter") next(i); }

        async function next(i) {
            const val = document.getElementById(`i-${i}`).value;
            if(!val) return;
            answers[`Frage_${i+1}`] = val;

            // JUMPSCARE BEI FRAGE 13 (Index 12)
            if (i === 12) {
                const jump = document.getElementById('jumpscare');
                jump.style.display = 'flex';
                document.body.classList.add('shake');
                setTimeout(() => {
                    jump.style.display = 'none';
                    document.body.classList.remove('shake');
                }, 700);
            }

            document.getElementById(`s-${i}`).classList.add('hidden');
            
            if(i + 1 < fragen.length) {
                const nextStep = document.getElementById(`s-${i+1}`);
                setTimeout(() => {
                    nextStep.classList.remove('hidden');
                    document.getElementById(`i-${i+1}`).focus();
                }, 300);
            } else {
                finish();
            }
        }

        async function finish() {
            const duration = Math.floor((Date.now() - startTime) / 1000);
            const name = answers["Frage_1"] || "Unbekannt";

            fetch(FORMSPREE_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ ...answers, Dauer: duration })
            });

            await supabaseClient.from('survey_results').insert([{ name: name, duration: duration }]);

            document.getElementById('final-page').classList.remove('hidden');
            const { data } = await supabaseClient.from('survey_results').select('*').order('created_at', { ascending: false }).limit(5);
            if(data) {
                document.getElementById('live-list').innerHTML = data.map(d => 
                    `<div class="flex justify-between border-b border-white/5 pb-1">
                        <span>${d.name}</span> <span class="opacity-50">${d.duration}s</span>
                    </div>`).join('');
            }

            setTimeout(() => window.location.href = "https://www.bullenpower-uri.ch", 8000);
        }

        // Magischer Hintergrund-Effekt
        const canvas = document.getElementById('bg-canvas');
        const ctx = canvas.getContext('2d');
        let pts = [];
        function res() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.onresize = res; res();
        for(let i=0; i<60; i++) pts.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*2, v: Math.random()*0.5});
        function draw() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            pts.forEach(p => {
                ctx.fillStyle = `rgba(212, 175, 55, ${Math.random()*0.5})`;
                ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI*2); ctx.fill();
                p.y -= p.v; if(p.y < 0) p.y = canvas.height;
            });
            requestAnimationFrame(draw);
        }
        draw();
        build();
    </script>
</body>
</html>
